---
compatible_cuba_versions: 7.0+
compatible_java_versions: 8+
project_id: cuba-petclinic-intro-to-reports
permalink: introduction-to-reports
---
= Introduction to Reports and Document generation
:showtitle:
:sectlinks:
:sectanchors:
:page-navtitle: Introduction to Reports and Document generation
:page-excerpt: In this guide the reports application component will be introduced and different ways to interact with it through the UI and programmatically will be shown
:page-root: ../../../
:project_id: cuba-petclinic-intro-to-reports
:java_version: 1.8
:cuba_version: 7.0


CUBA applications can be enhanced to have a comprehensive report / document generation capability directly embedded into the application. The CUBA application component `reports` supports various file formats like `docx`, `xlsx`, `PDF`, `HTML` for templating as well as output file formats. Furthermore it contains management screens and provides APIs to interact with the report / document generation process programmatically.

In this guide the reports application component will be introduced and different ways to interact with it through the UI and programmatically will be shown.

== What Will be Built

This guide enhances the https://github.com/cuba-platform/cuba-petclinic[CUBA Petclinic] example to show how report capabilities can be embedded into the application:

* a `recent-visits` report can be downloaded from the visit browse screen. The report contains visits of the last month, exported as an excel sheet with information about the visit, the referenced pet and its owner.
* a `patient-record` word document containing all relevant information (master data, visit data) for a given pet can be downloaded through the detail screen of the pet.
* an invoice for a visit is automatically generated once a visit is resolved and attached as a PDF file to the visit
* a report counting the visits per pet type are displayed as an ad-hoc report as a CUBA table within the application

=== Final Application

++++
<a href="https://raw.githubusercontent.com/cuba-guides/cuba-petclinic-i18n-messages/master/img/adjustments-cuba-petclinic-overview.gif"><img src="https://raw.githubusercontent.com/cuba-guides/cuba-petclinic-i18n-messages/master/img/login-screen.png"/></a>
++++

include::includes/guide_requirements.adoc[]


include::includes/petclinic_introduction.adoc[]

== Overview

Oftentimes when working with business applications there is a high demand for document generation, that will take some information from the source application and bring it in the form of a commonly known format, so that it can be shared with other parties like customers, partners or other systems.

These documents might either have the form of human consumable content like a PDF file or are more used as input data for further use like a CSV / Excel file or a Word document.

CUBA being targeted towards the needs of business applications in particular has dedicated support for this kind of use cases through the `reports` application component.

It has the ability to define formatted document templates and declare the data that should be used for the document. This definition is done in a declarative way, that does not require development of code in order to generate reports / documents. It is possible for developers as well as administrators and business users with mid-level technical skills.

=== Example Use Cases

As mentioned above there are lots of example use cases, that deal with generating documents / reports out of a source application. Here's a list of examples:

* create a excel sheet of the TOP 10 of customers with the highest total turnovers
* generate an invoice document for an order stored in the application in PDF format
* create payment data file as a CSV file for file exchange between the payment system and the BI system
* show a list of best selling products aggregated by category as an application screen
* create HTML file of latest sales offers in order to upload & publish this file on a website

All of those requirements are part of what the `reports` application component is capable on handling. In the next section the overall concepts are covered and afterwards example use cases are implemented.

== Templates + Data = Document

The underpinning of this whole solution is based on on the combination of document templates with data, that are merged in order to create the resulting document / report.

=== The Document Template
The document template is a file that acts as the blueprint for how the target file should look like. It contains placeholders as particular text snippets, that the `reports` application component can pick up and put the data into the document.

Those placeholders can inserted as regular text into the template file, but they need a special characters to indicate that this text is a placeholder. A placeholder is defined in the following form: `${NAME_OF_PLACEHOLDER}`

An example of a document template can be seen below. This example is an excel sheet, that is used later in this guide:

image::intro-to-reports/excel-document-template-example.png[align="center", link="images/intro-to-reports/excel-document-template-example.png"]

The template contains regular text as well as the placeholders for the different columns in the table like `${pet.name}` or `${pet.identificationNumber}`.

Furthermore it is possible to style and adjust the document template in whatever ways is desired. For Word and Excel documents, all the possible formatting options of those programs are able to be applied to the template file. For HTML documents the complete capabilities of CSS can be used for applying styles to the target document.

TIP: The template file format are not necessarily the file formats of the output document. It is possible to e.g. have a Word based document template that will generate a PDF file when merged with the data.

=== Data Sources

The data that is used for the report can be of various sources. Within a CUBA application fetching the data directly from the entity layer of the application is the most convenient variant. However, the reports application component is not bound to this particular data source. It can be one of the following data sources:

* CUBA Entities / JPQL
* SQL
* Groovy
* JSON

This various sources allow a high degree of flexibility when it comes to fetch data and provide it to the template file. It is also possible to define multiple data sources and combine all the data in the template.

== Report Entity: the Configuration Holder

Once the data sources are defined and connected through a concept called Bands to particular template placeholders, everything is setup to generate the output document. The application component stores all of this configuration in the entity `Report` which holds the configuration of the data sources together with the definition of the templates and further configuration information.


image::intro-to-reports/report-entity-configuration-screen.png[align="center", link="images/intro-to-reports/report-entity-configuration-screen.png"]

There are two main ways of creating those report records.

The first one is to create an instance manually and defining the data sources together with the associated JPQL / SQL queries / groovy scripts.

This is oftentimes needed when more complex reports should be defined which requires skills to create SQL / JPQL statements or even programming abilities through groovy scripts. This option
is mostly for administrators that have a deep technical understanding of the inner workings of the application. It furthermore requires knowledge about its domain model and an understanding of the technical concepts of the report application component like report bands, report parameters etc.

=== The Report Wizard

The second option is to use the report UI wizard that guides the user through the selection of various options. It includes the ability to define the conditions for entities to be selected for the report, the attributes that should be included. Furthermore it generates a base template which contains already the selected attributes as placeholders.

image::intro-to-reports/report-entity-wizard-1.png[align="center", link="images/intro-to-reports/report-entity-wizard-1.png"]

image::intro-to-reports/report-entity-wizard-2.png[align="center", link="images/intro-to-reports/report-entity-wizard-2.png"]

image::intro-to-reports/report-entity-wizard-3.png[align="center", link="images/intro-to-reports/report-entity-wizard-3.png"]

This variant is targeted more towards business users, since it hides away the technical details of e.g. the query definition behind a user-friendly configuration UI. For easier reports, this wizard can serve as the main UI for creating reports by business users directly.

With the feature of generating a document template that contains the correct placeholders of the selected attributes is allows the business users to only change the formatting of the output document. This template formatting normally happens in the application that they are already familiar with like Word or Excel. The main difference is that this opens up possibilities for non-technical people to work with reports without the need of any developer interaction.

That being said, even for technical people it is oftentimes the fastest way to create a report or at least a starting point for manual adjustments.

One constraint for the report wizard is that it is tied to generating reports / document based on the CUBA entity layer. Groovy / SQL based reports cannot be directly created through the wizard. However, it is possible to use the wizard report as a first step and then adjust the resulting report's bands accordingly through the regular management screen.

== Summary

== Further Information

* https://doc.cuba-platform.com/manual-{cuba_version}/messages.html[CUBA docs: Messages Interface]
* https://doc.cuba-platform.com/manual-{cuba_version}/localization.html[CUBA docs: Localization]