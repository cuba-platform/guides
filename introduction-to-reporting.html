<!doctype html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en"> <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Reporting and Document generation</title>
    <meta name="description" content="The CUBA Platform guides cover different aspects of the CUBA Platform and give you advice on how to work with CUBA Platform by giving you concrete examples.">
    <meta name="author" content="Haulmont">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@CubaPlatform">
    <meta name="twitter:creator" content="@CubaPlatform">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Introduction to Reporting and Document generation">
    <meta property="og:description" content="In this guide the Reporting add-on will be introduced and different ways to interact with it through the UI and programmatically will be shown">
    <meta property="og:url" content="https://www.cuba-platform.com/guides/introduction-to-reporting">
    <meta property="og:image" content="">

    <link rel="shortcut icon" href="/guides/images/favicon.png" type="image/png" />
    <link rel="stylesheet" href="/guides/css/foundation.css">
    <link rel="stylesheet" href="/guides/css/font-awesome.css">
    <link rel="stylesheet" href="/guides/css/coderay.css">
    <link rel="stylesheet" href="/guides/css/bootstrap.css">
    <link rel="stylesheet" href="https://www.cuba-platform.com/sites/all/themes/cuba_adaptive/css/reset.css">
    <link rel="stylesheet" href="https://www.cuba-platform.com/sites/all/themes/cuba_adaptive/css/animate.css">
    <link rel="stylesheet" href="/guides/css/extra.css">
    <link rel="stylesheet" href="/guides/css/extra2.css">
    <link rel="stylesheet" href="/guides/css/cuba-new.css">
    <link rel="stylesheet" href="/guides/css/font-awesome.min.css">
    <link rel="stylesheet" href="/guides/css/guides.css">
    <script src="/guides/js/jquery_v2.1.min.js"></script>
    <link rel="stylesheet" href="/guides/css/main.css" />
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-962 node-type-blog-post i18n-en">

<section id="wrapper">
    
<header role="banner" fragment="14269c1b298" class="header">
    <nav class="header_nav">
        <input id="mobile-menu-open" type="checkbox" class="header_checkbox">
        <div class="container header_container">
            <div class="header_toggle">
                <label for="mobile-menu-open"
                       class="header_toggle-label toggle-label">
                    <span>CUBA.platform</span>
                </label>
            </div>
            <a href="/" class="header_logo nuxt-link-active"></a>
            <ul class="header_menu">
                <li class="header_menu_item"><a href="/framework/" class="header_menu_link">Framework</a></li>
                <li class="header_menu_item"><a href="/learn/" class="header_menu_link nuxt-link-active">Learn</a></li>
                <li class="header_menu_item"><a href="/documentation/" class="header_menu_link">Documentation</a></li>
                <li class="header_menu_item"><a href="/discuss/" class="header_menu_link">Forum</a></li>
                <li class="header_menu_item"><a href="/blog/" class="header_menu_link">Blog</a></li>
            </ul>
            <div class="header-support">
                <button class="header-support_toggle">
                <img src="images/users.svg" class="header-support_toggle_icon">
                <span class="header-support_toggle_text">Services</span></button>
                <div class="header-support_popup">
                    <div class="support-popup">
                        <div class="support-popup_services">
                            <h3 class="support-popup_services_title">Commercial services for your project</h3>
                            <ul class="services-list">
                                <li class="services-list_item"><a href="/support-options/"><strong
                                        class="services-list_title">Consultancy &amp; Support</strong>
                                    <div class="services-list_text">
                                        <div><p>Commercial consulting requests have a guaranteed response
                                            time.</p>
                                        </div>
                                    </div>
                                </a></li>
                                <li class="services-list_item"><a href="/development/"><strong
                                        class="services-list_title">Custom Development</strong>
                                    <div class="services-list_text">
                                        <div><p>We can deliver a turn key solution or contribute to your
                                            project</p>
                                        </div>
                                    </div>
                                </a></li>
                                <li class="services-list_item"><a href="/training/"><strong
                                        class="services-list_title">Training</strong>
                                    <div class="services-list_text">
                                        <div><p>For fast and deep dive into framework features to shift your
                                            team productivity.</p>
                                        </div>
                                    </div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="support-popup_haulmont">
                            <div class="support-popup_haulmont_header"><h3 class="support-popup_haulmont_title">
                                Haulmont</h3>
                                <div class="support-popup_haulmont_subtitle">we develop modern enterprise
                                    solutions
                                </div>
                            </div>
                            <ul class="haulmont-list">
                                <li class="haulmont-list_item">
                                    <div><p>Experts in Enterprise software</p>
                                    </div>
                                </li>
                                <li class="haulmont-list_item">
                                    <div><p>Creators of the CUBA Platform</p>
                                    </div>
                                </li>
                                <li class="haulmont-list_item">
                                    <div><p>Established in 2008</p>
                                    </div>
                                </li>
                            </ul>
                            <ul class="numbers-list">
                                <li class="numbers-list_item"><strong class="numbers-list_number">300+</strong>
                                    <div class="numbers-list_text">developers</div>
                                </li>
                                <li class="numbers-list_item"><strong class="numbers-list_number">400+</strong>
                                    <div class="numbers-list_text">projects</div>
                                </li>
                                <li class="numbers-list_item">
                                    <div class="numbers-list_text">Customers in</div>
                                    <strong class="numbers-list_number">60+</strong>
                                    <div class="numbers-list_text">countries</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <a href="/user/" class="header_profile">
                <svg xmlns="http://www.w3.org/2000/svg" id="i-profile" class="icon header_profile_src" viewBox="0 0 563.43 563.43" width="100%" height="100%">
                    <path d="M280.79 314.559c83.266 0 150.803-67.538 150.803-150.803S364.055 13.415 280.79 13.415 129.987 80.953 129.987 163.756s67.537 150.803 150.803 150.803zm0-261.824c61.061 0 111.021 49.959 111.021 111.021s-49.96 111.02-111.021 111.02-111.021-49.959-111.021-111.021 49.959-111.02 111.021-111.02zM19.891 550.015h523.648c11.102 0 19.891-8.789 19.891-19.891 0-104.082-84.653-189.198-189.198-189.198H189.198C85.116 340.926 0 425.579 0 530.124c0 11.102 8.789 19.891 19.891 19.891zm169.307-169.307h185.034c75.864 0 138.313 56.436 148.028 129.524H41.17c9.714-72.625 72.164-129.524 148.028-129.524z"></path>
                </svg>
            </a>
        </div>
    </nav>
    <nav class="header-submenu">
        <div class="container header-submenu_container">
            <a href="/learn/quickstart/" class="header-submenu_link">Quick Start</a>
            <a href="/learn/live-demo/" class="header-submenu_link">Live Demo</a>
            <a href="/guides/" class="header-submenu_link nuxt-link-exact-active nuxt-link-active">Guides</a>
        </div>
    </nav>
</header>

<style>
    .upper-header .header-options {
        display: none;
    }

    .upper-header .upper-header-wrapper .header-menu div .nav > li:last-child > a {
        padding-right: 0;
    }
</style>

    <!-- Main Page Content and Sidebar -->
    <div class="content-wrapper">
        <div class="cuba-container text-node blog">



            <!-- Main content (left column) -->
            <div class="region region-content">



                <section id="block-system-main" class="block block-system clearfix">
                    <div id="node-962" class="article node node-blog-post node-promoted clearfix">
                        <div class="content">
                            <div class="field field-name-body field-type-text-with-summary field-label-hidden">
                                <div class="field-items">
                                    <div class="field-item even" property="content: encoded">
                                        <h1>Introduction to Reporting and Document generation</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>CUBA applications can be enhanced to have a comprehensive report / document generation capability directly embedded into the application. The CUBA add-on <code>Reporting</code> supports various file formats like <code>DOCX</code>, <code>XLSX</code>, <code>PDF</code>, <code>HTML</code> for templating as well as output file formats. Furthermore, it contains management screens and provides APIs to interact with the report / document generation process programmatically.</p>
</div>
<div class="paragraph">
<p>In this guide the <code>Reporting</code> add-on will be introduced and different ways to interact with it through the UI and programmatically will be shown.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what_will_be_built"><a class="anchor" href="#what_will_be_built"></a><a class="link" href="#what_will_be_built">What Will be Built</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide enhances the <a href="https://github.com/cuba-platform/cuba-petclinic">CUBA Petclinic</a> example to show how reporting capabilities can be embedded into the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>patient-record</code> word document containing all relevant information (master data, visit data) for a given pet can be downloaded through the details screen of the pet.</p>
</li>
<li>
<p>a <code>recent-visits</code> report can be downloaded from the visit browse screen. The report contains visits of the last month, exported as an excel sheet with information about the visit, the referenced pet and its owner.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="final_application"><a class="anchor" href="#final_application"></a><a class="link" href="#final_application">Final Application</a></h3>
<a href="https://raw.githubusercontent.com/cuba-guides/cuba-petclinic-intro-to-reports/master/img/adjustments-cuba-petclinic-overview.gif"><img src="https://raw.githubusercontent.com/cuba-guides/cuba-petclinic-intro-to-reports/master/img/login-screen.png"/></a>
</div>
<div class="sect2">
<h3 id="requirements"><a class="anchor" href="#requirements"></a><a class="link" href="#requirements">Requirements</a></h3>
<div class="paragraph">
<p>Your development environment requires to contain the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK 1.8</a></p>
</li>
<li>
<p>a text editor or IDE (<a href="https://www.jetbrains.com/idea/download/">IntelliJ IDEA</a> preferred)</p>
</li>
<li>
<p><a href="https://www.cuba-platform.com/download">CUBA Studio</a> as standalone IDE or as an IDEA plugin (optional)</p>
</li>
<li>
<p><a href="https://github.com/cuba-platform/cuba-cli/wiki/Installation">CUBA CLI</a> (optional)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/cuba-guides/cuba-petclinic-intro-to-reporting/archive/master.zip">Download</a> and unzip the source repository for this guide, or clone it using git:</p>
</div>
<div class="paragraph">
<p><code>git clone <a href="https://github.com/cuba-guides/cuba-petclinic-intro-to-reporting.git" class="bare">https://github.com/cuba-guides/cuba-petclinic-intro-to-reporting.git</a></code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example_cuba_petclinic"><a class="anchor" href="#example_cuba_petclinic"></a><a class="link" href="#example_cuba_petclinic">Example: CUBA petclinic</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The project that is the basis for this example is <a href="https://github.com/cuba-platform/cuba-petclinic">CUBA Petclinic</a>. It is based on the commonly known <a href="https://github.com/spring-projects/spring-petclinic">Spring Petclinic</a>. The CUBA Petclinic application deals with the domain of a Pet clinic and the associated business workflows to manage a pet clinic.</p>
</div>
<div class="paragraph">
<p>The underlying domain model for the application looks like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/guides/images/domain-model.png" alt="Domain model">
</div>
</div>
<div class="paragraph">
<p>The main entities are <strong>Pet</strong> and <strong>Visit</strong>. A Pet is visiting the petclinic and during this Visit a Vet is taking care of it. A Pet belongs to an Owner, which can hold multiple pets. The visit describes the act of a pet visiting the clinic with the help of its owner.</p>
</div>
<a href="https://raw.githubusercontent.com/cuba-platform/cuba-petclinic/master/img/cuba-petclinic-overview.gif"><img src="https://raw.githubusercontent.com/cuba-platform/cuba-petclinic/master/img/login-screen.png"/></a>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a><a class="link" href="#overview">Overview</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Oftentimes when working with business applications there is a high demand for document generation, that will take some information from the source application and bring it in the form of a commonly known format, so that it can be shared with other parties like customers, partners or other systems.</p>
</div>
<div class="paragraph">
<p>These documents might either have the form of human consumable content like a PDF file or are  used more as input data for further use like a CSV / Excel file or a Word document.</p>
</div>
<div class="paragraph">
<p>CUBA, being targeted towards the needs of business applications, in particular has dedicated support for this kind of use cases through the <code>Reporting</code> add-on.</p>
</div>
<div class="paragraph">
<p>It has the ability to define formatted document templates and declare the data that should be used for the document. This definition is done in a declarative way, that does not require writing any code in order to generate reports / documents. It is possible for developers as well as administrators and business users with mid-level technical skills.</p>
</div>
<div class="sect2">
<h3 id="example_use_cases"><a class="anchor" href="#example_use_cases"></a><a class="link" href="#example_use_cases">Example Use Cases</a></h3>
<div class="paragraph">
<p>As it was mentioned above, there are lots of use cases that deal with generating documents / reports out of a source application. Here&#8217;s a list of examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create an excel sheet of the TOP 10 customers with the highest total turnovers</p>
</li>
<li>
<p>generate an invoice for an order stored in the application in PDF format</p>
</li>
<li>
<p>create payment data file as a CSV file for file exchange between the payment system and the BI system</p>
</li>
<li>
<p>show a list of best sold products aggregated by category as an application screen</p>
</li>
<li>
<p>create an HTML file of the latest sales offers in order to upload &amp; publish this file on a website</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of those requirements are the part of what the <code>Reporting</code> add-on is capable of handling. In the next section the overall concepts are covered and afterwards use cases are implemented.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="templates_data_document"><a class="anchor" href="#templates_data_document"></a><a class="link" href="#templates_data_document">Templates + Data = Document</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The underpinning of this whole solution is based on on the combination of document templates with data, that are merged in order to create the resulting document / report.</p>
</div>
<div class="sect2">
<h3 id="the_document_template"><a class="anchor" href="#the_document_template"></a><a class="link" href="#the_document_template">The Document Template</a></h3>
<div class="paragraph">
<p>The document template is a file that acts as a blueprint for how the target file should look like. It contains placeholders as particular text snippets, that the <code>Reporting</code> add-on can pick up and put the data into the document.</p>
</div>
<div class="paragraph">
<p>Those placeholders can be inserted as regular text into the template file, but they need a special character to indicate that this text is a placeholder. A placeholder is defined in the following way: <code>${NAME_OF_PLACEHOLDER}</code></p>
</div>
<div class="paragraph">
<p>An example of a document template can be seen below. This example is an excel sheet, that is used later in this guide:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/excel-document-template-example.png"><img src="/guides/images/intro-to-reports/excel-document-template-example.png" alt="excel document template example"></a>
</div>
</div>
<div class="paragraph">
<p>The template contains regular text as well as the placeholders for different columns in a table like <code>${pet.name}</code> or <code>${pet.identificationNumber}</code>.</p>
</div>
<div class="paragraph">
<p>Furthermore, it is possible to style and adjust the document template in any desired ways. For Word and Excel documents all the possible formatting options of those programs are able to be applied to the template file. For HTML documents the complete capabilities of CSS can be used for applying styles to the target document.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The template file format is not necessarily the file format of the output document. It is possible to e.g. have a Word based document template that will generate a PDF file when merged with the data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="data_sources"><a class="anchor" href="#data_sources"></a><a class="link" href="#data_sources">Data Sources</a></h3>
<div class="paragraph">
<p>The data that is used for the report can be of various sources. Within a CUBA application fetching the data directly from the entity layer of the application is the most convenient variant. However, the <code>Reporting</code> add-on is not bound to this particular data source. It can use one of the following data sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CUBA Entities / JPQL</p>
</li>
<li>
<p>SQL</p>
</li>
<li>
<p>Groovy</p>
</li>
<li>
<p>JSON</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These various sources provide a high degree of flexibility when it comes to fetch data and provide it to the template file. It is also possible to define multiple data sources and combine all the data in the template.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="report_configuration"><a class="anchor" href="#report_configuration"></a><a class="link" href="#report_configuration">Report Configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the data sources are defined and connected through a concept called Bands to particular template placeholders, everything is setup to generate the output document. The add-on stores all this configuration in the <code>Report</code> entity which holds the configuration of the data sources together with the definition of the templates and further configuration information.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-configuration-screen.png"><img src="/guides/images/intro-to-reports/report-entity-configuration-screen.png" alt="report entity configuration screen"></a>
</div>
</div>
<div class="paragraph">
<p>There are two main ways of creating those report records.</p>
</div>
<div class="paragraph">
<p>The first one is to create an instance manually and define the data sources together with the associated JPQL / SQL queries / groovy scripts.</p>
</div>
<div class="paragraph">
<p>This is oftentimes needed when more complex reports should be defined which requires skills to create SQL / JPQL statements or even programming abilities through groovy scripts. This option
is mostly for administrators that have a deep technical understanding of the inner processes of the application. It furthermore requires knowledge about its domain model and an understanding of the technical concepts of the Reporting add-on like report bands, report parameters etc.</p>
</div>
<div class="sect2">
<h3 id="the_report_wizard"><a class="anchor" href="#the_report_wizard"></a><a class="link" href="#the_report_wizard">The Report Wizard</a></h3>
<div class="paragraph">
<p>The second option is to use the report UI wizard that guides the user through the selection of various options. It includes the ability to define the conditions for entities to be selected for the report, the attributes that should be included. Furthermore, it generates a base template which already contains the selected attributes as placeholders.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-wizard-1.png"><img src="/guides/images/intro-to-reports/report-entity-wizard-1.png" alt="report entity wizard 1"></a>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-wizard-2.png"><img src="/guides/images/intro-to-reports/report-entity-wizard-2.png" alt="report entity wizard 2"></a>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-wizard-3.png"><img src="/guides/images/intro-to-reports/report-entity-wizard-3.png" alt="report entity wizard 3"></a>
</div>
</div>
<div class="paragraph">
<p>This variant is more targeted towards business users, since it hides away the technical details of e.g. the query definition behind a user-friendly configuration UI. For easier reports, this wizard can serve as the main UI for creating reports by business users directly.</p>
</div>
<div class="paragraph">
<p>With the feature of generating a document template that contains the correct placeholders of the selected attributes is allows business users to change only the formatting of the output document. This template formatting normally happens in the application that they are already familiar with like Word or Excel. The main difference is that this opens up possibilities for non-technical people to work with reports without the need of any developer interaction.</p>
</div>
<div class="paragraph">
<p>That being said, also, for tech-savvy people it is oftentimes the fastest way to create a report or at least a starting point for manual adjustments.</p>
</div>
<div class="paragraph">
<p>One constraint for the report wizard is that it is tied to generating reports / documents based on the CUBA entity layer. Groovy / SQL based reports cannot <em>directly</em> be created through the wizard. However, it is possible to use the wizard report as a first step and then adjust the resulting reports bands accordingly through the regular management screen.</p>
</div>
</div>
<div class="sect2">
<h3 id="external_parameters"><a class="anchor" href="#external_parameters"></a><a class="link" href="#external_parameters">External Parameters</a></h3>
<div class="paragraph">
<p>A Report configuration can declare external parameters that need to be provided by the person or application code that interacts with the report. Those parameters are mainly used for the data fetching parts. In the JPQL / SQL statements as well as the groovy based data bands, those parameters are passed in to dynamically inject the values into the query / the groovy script.</p>
</div>
<div class="paragraph">
<p>The configuration of the external parameters in the Reports configuration screen looks like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-configuration-external-parameters.png"><img src="/guides/images/intro-to-reports/report-entity-configuration-external-parameters.png" alt="report entity configuration external parameters"></a>
</div>
</div>
<div class="paragraph">
<p>When external parameters are defined, the values can be entered in two ways. The first way is to expose these parameters as a form in the generic UI. It will appear at the point when the report is executed through the generic Reports execution UI. An example of such a UI can be seen here:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-external-parameters-dynamic-ui.png"><img src="/guides/images/intro-to-reports/report-external-parameters-dynamic-ui.png" alt="report external parameters dynamic ui"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="patient_record"><a class="anchor" href="#patient_record"></a><a class="link" href="#patient_record">Patient Record</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first report that should be generated is a patient record for a given pet. It contains an overview of the pet&#8217;s master data as well as visit data form that pet.</p>
</div>
<div class="paragraph">
<p>In this case the document template will be a Word document. However, the target document will be a PDF file.</p>
</div>
<div class="paragraph">
<p>The report will have the following default settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Report Entity: <code>Pet (petclinic_Pet)</code></p>
</li>
<li>
<p>Template Type: <code>DOCX</code></p>
</li>
<li>
<p>Report Name: <code>Patient Record</code></p>
</li>
<li>
<p>Report Type: <code>Report for single entity</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="defining_the_attributes"><a class="anchor" href="#defining_the_attributes"></a><a class="link" href="#defining_the_attributes">Defining the Attributes</a></h3>
<div class="paragraph">
<p>The direct master data of the pet are similar to what has been selected in the <code>recent-visits</code> report, basically the data of the Pet entity as well as the associated Owner entity.</p>
</div>
<div class="paragraph">
<p>In order to display a list of associated visits of this Pet entity, another data band has to be created. This is possible during the initial Reporting wizard.</p>
</div>
<div class="paragraph">
<p>In the second step after initially defining the direct attributes of the entity, it is possible to create additional "regions" in the report. Those regions are basically translated to a particular data bands that are generated out of those selections.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-entity-wizard-add-tabular-section.png"><img src="/guides/images/intro-to-reports/report-entity-wizard-add-tabular-section.png" alt="report entity wizard add tabular section"></a>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring_the_output_document"><a class="anchor" href="#configuring_the_output_document"></a><a class="link" href="#configuring_the_output_document">Configuring the Output document</a></h3>
<div class="paragraph">
<p>The output document for this report contains one template defined initially through the report wizard. The corresponding section in the Report Configuration screen therefore contains one template entry.</p>
</div>
<div class="paragraph">
<p>The output type is set to <code>PDF</code> while the template file is <code>DOCX</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-configuration-default-template.png"><img src="/guides/images/intro-to-reports/report-configuration-default-template.png" alt="report configuration default template"></a>
</div>
</div>
<div class="paragraph">
<p>Additionally, it is possible to define the filename of the output document. This can either be a static filename or it can be programmatically configured.</p>
</div>
<div class="paragraph">
<p>In this case, the filename should look like this for the Pet with the name "Horsea": <code>Patient Record - Horsea.pdf</code>.</p>
</div>
<div class="paragraph">
<p>In order to achieve this, a pattern can be configured whicn in this case references to a particular band: <code>${Root.title}.pdf</code></p>
</div>
<div class="paragraph">
<p><code>Root.title</code> refers to the <code>title</code> value of the <code>Root</code> data band. A groovy based data set will define the value for the title attribute like this:</p>
</div>
<div class="listingblock">
<div class="title">Title data set in Root data band</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> petName = params[<span class="string"><span class="delimiter">&quot;</span><span class="content">entity</span><span class="delimiter">&quot;</span></span>][<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>] <i class="conum" data-value="1"></i><b>(1)</b>

<span class="keyword">return</span> [
    [<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">Patient Record - </span><span class="inline"><span class="inline-delimiter">$</span>petName</span><span class="delimiter">&quot;</span></span>] <i class="conum" data-value="2"></i><b>(2)</b>
]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the params variable gives access to the different external parameters. <code>params["entity"]</code> refers to the selected pet instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>a List of Maps has to be returned from this groovy script. Under the key <code>title</code> it will put the target filename</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The resulting usage of the groovy based data set looks like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-configuration-report-output-title.png"><img src="/guides/images/intro-to-reports/report-configuration-report-output-title.png" alt="report configuration report output title"></a>
</div>
</div>
</div>
<div class="sect2">
<h3 id="libreoffice_for_accurate_word_to_pdf_conversion"><a class="anchor" href="#libreoffice_for_accurate_word_to_pdf_conversion"></a><a class="link" href="#libreoffice_for_accurate_word_to_pdf_conversion">LibreOffice for accurate Word to PDF conversion</a></h3>
<div class="paragraph">
<p>After configuring the output document to be PDF, adjustments need to be made in the configuration of the application. In order to increase the accuracy of the PDF output document, CUBA is able to leverage the conversion facilities of LibreOffice.</p>
</div>
<div class="paragraph">
<p>LibreOffice has an API that other programs can use to convert different file formats (especially PDF file generation). The <code>Reporting</code> add-on uses this API when LibreOffice is installed on the operating system and configured in the CUBA application properties.</p>
</div>
<div class="listingblock">
<div class="title">app.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">reporting.openoffice.docx.useOfficeForDocumentConversion = true

## Unix:
# reporting.openoffice.path = /usr/lib/libreoffice/program

## Windows:
# reporting.openoffice.path = C:/Program Files (x86)/LibreOffice 5/program

## MacOS:
reporting.openoffice.path = /Applications/LibreOffice.app/Contents/MacOS</code></pre>
</div>
</div>
<div class="paragraph">
<p>The usage of LibreOffice has to be activated and additionally the path to the LibreOffice binary has to be configured to CUBA. Once this configuration is done, the CUBA application is able to render PDF files from <code>DOCX</code> and <code>XSLX</code> templates.</p>
</div>
<div class="paragraph">
<p>More information on the configuration can be found in the official Reporting docs: <a href="https://doc.cuba-platform.com/reporting-7.1/open_office.html">Appendix A: Installing and Configuring OpenOffice</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="running_the_report_from_the_pet_detail_screen"><a class="anchor" href="#running_the_report_from_the_pet_detail_screen"></a><a class="link" href="#running_the_report_from_the_pet_detail_screen">Running the Report from the Pet Detail Screen</a></h3>
<div class="paragraph">
<p>There are two variants on how to run a report programmatically from a screen.</p>
</div>
<div class="paragraph">
<p>In this variant, the report configuration itself determines in which screens it should be "available". The remaining code in the controller just declares, that it wants to print a report and the Reporting add-on will then figure out which reports are possible in this context.</p>
</div>
<div class="paragraph">
<p>The corresponding configuration section in the Reporting is "Roles and Screens". Within this section a list of UI screens can be configured in which the report is available.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/report-configuration-roles-and-screens.png"><img src="/guides/images/intro-to-reports/report-configuration-roles-and-screens.png" alt="report configuration roles and screens"></a>
</div>
</div>
<div class="paragraph">
<p>The screen <code>petclinic_Pet.edit</code> is added to the list of screens on the right side of the configuration interface.</p>
</div>
<div class="paragraph">
<p>In the target UI screen, the following code is added in order to trigger the report execution.</p>
</div>
<div class="listingblock">
<div class="title">pet-edit.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;hbox</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">editActions</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">spacing</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">windowCommitAndClose</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">windowClose</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">patientRecordBtn</span><span class="delimiter">&quot;</span></span>
            <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">msg://patientRecord</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;/hbox&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>a new <code>patientRecordBtn</code> is placed next to the default save &amp; close buttons</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">PetEdit.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.haulmont.reports.gui.actions.EditorPrintFormAction</span>;

<span class="annotation">@UiController</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">petclinic_Pet.edit</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">PetEdit</span> <span class="directive">extends</span> StandardEditor&lt;Pet&gt; {

    <span class="annotation">@Inject</span>
    <span class="directive">protected</span> <span class="predefined-type">Button</span> patientRecordBtn;

    <span class="annotation">@Subscribe</span>
    <span class="directive">protected</span> <span class="type">void</span> onInit(InitEvent event) {
        patientRecordBtn.setAction( <i class="conum" data-value="1"></i><b>(1)</b>
                <span class="keyword">new</span> EditorPrintFormAction(<span class="local-variable">this</span>, <span class="predefined-constant">null</span>) <i class="conum" data-value="2"></i><b>(2)</b>
        );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the action is configured at the init event of the edit screen</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the <code>EditorPrintFormAction</code> from the <code>Reporting</code> add-on is used, which automatically searches for reports that are configured in this screen</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In case multiple reports are configured to be available, the user is prompted with a pop-up to select the correct report to run. In this case, there is only one report configured for this screen, which results in automatic execution of that report without any further required interaction with the user.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="recent_visits_report"><a class="anchor" href="#recent_visits_report"></a><a class="link" href="#recent_visits_report">Recent Visits Report</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The second example that should be generated by the application is the <code>recent-visits</code> report. It should be accessible as a download directly from the visit browse screen. The report contains visits of the last month, exported as an excel sheet with information about the visit, the referenced pet and its owner.</p>
</div>
<div class="paragraph">
<p>In order to fulfill this requirement the first step is to create a report via the Report Wizard. The following main settings are set:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Report Entity: <code>Visit (petclinic_Visit)</code></p>
</li>
<li>
<p>Template Type: <code>XLSX</code></p>
</li>
<li>
<p>Report Name: <code>Vists by Period</code></p>
</li>
<li>
<p>Report Type: <code>Report for list of entities, selected by query</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next step is to define the query. The report Wizard allows users to set the query by defining conditions through the UI.</p>
</div>
<div class="paragraph">
<p>In this report the visits of the last month should be selected. However, the concept of "relative dates" is not present in the Reporting add-on directly. Due to this, this piece of logic has to be externalized to the code that triggers the report run.</p>
</div>
<div class="paragraph">
<p>The report itself is going to be a little more generic in the sense that it allows to specify a period that defines the date range of the visits that will be taken into consideration. This also has the benefit: the report is potentially re-usable for other future use-cases.</p>
</div>
<div class="paragraph">
<p>The query consists of two conditions for the attribute <code>visitDate</code>. It should match a value that is within the range of two dates: "Visit Date Range Start" and "Visit Date Range End". The only difference between the two conditions is that for the first condition the "operation" is <code>greater or equal than: &gt;=</code> while the second condition has the operation <code>smaller than: &lt;</code>. With that, the boundaries of the range are expressed as conditions.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/intro-to-reports/visit-by-period-date-range-creteria.png"><img src="/guides/images/intro-to-reports/visit-by-period-date-range-creteria.png" alt="visit by period date range creteria"></a>
</div>
</div>
<div class="paragraph">
<p>For each condition an external parameter will be created so that the concrete values can be inserted programmatically or alternatively by a user through a UI.</p>
</div>
<div class="sect2">
<h3 id="selecting_entity_attributes_of_the_visit_entity"><a class="anchor" href="#selecting_entity_attributes_of_the_visit_entity"></a><a class="link" href="#selecting_entity_attributes_of_the_visit_entity">Selecting Entity Attributes of the Visit Entity</a></h3>
<div class="paragraph">
<p>The next step in the wizard is to define the attributes of the base entity (Visit) and its associated entities that should be part of the report. The selection will influence, on the one hand, the <code>SELECT</code> part of the JPQL statement that is used to fetch the data. On the other hand, it influences the initial version of the columns within the template, that is generated for this report when finishing the report wizard.</p>
</div>
<div class="paragraph">
<p>For the <code>recent-visits</code> Report, the following attributes should be selected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Visit Date: <code>visitDate</code></p>
</li>
<li>
<p>Visit Description: <code>description</code></p>
</li>
<li>
<p>Information about the associated Pet</p>
<div class="ulist">
<ul>
<li>
<p>the Pet&#8217;s name: <code>pet.name</code></p>
</li>
<li>
<p>the Pet&#8217;s Identification Number: <code>pet.identificationNumber</code></p>
</li>
<li>
<p>Type of the Pet: <code>pet.type.name</code></p>
</li>
<li>
<p>The city where the Pet lives (expressed through the address of its owner): <code>pet.owner.city</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After selecting the attributes through the UI wizard, the output template file type can be configured. In this example, the default settings are applicable.</p>
</div>
<div class="paragraph">
<p>With that the report wizard is finished and the report configuration is shown for further adjustments.</p>
</div>
</div>
<div class="sect2">
<h3 id="providing_external_parameters_programmatically"><a class="anchor" href="#providing_external_parameters_programmatically"></a><a class="link" href="#providing_external_parameters_programmatically">Providing External Parameters Programmatically</a></h3>
<div class="paragraph">
<p>For the use case of the <code>recent-visits</code> report the generic UI is not exposed to the user. Instead, the parameters are passed in by the API call to run the report.</p>
</div>
<div class="paragraph">
<p>In the <code>patient-record</code> report, the report screen connection was configured in the report configuration.</p>
</div>
<div class="paragraph">
<p>There is an alternative approach on how to trigger report execution, which will be leveraged in this example.</p>
</div>
<div class="paragraph">
<p>In this case the report instance is selected programmatically (through the <code>system code</code> attribute) and directly passed into the reports API in order to execute the report and download the resulting document.</p>
</div>
<div class="paragraph">
<p>The complete listing for the triggering of the <code>recent-visits</code> report shows the main steps of:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>identifying the last month (externalized logic of relative date)</p>
</li>
<li>
<p>loading the report instance to execute</p>
</li>
<li>
<p>triggering the report execution and passing in the last month as a parameter</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">VisitBrowse.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">VisitBrowse</span> <span class="directive">extends</span> StandardLookup&lt;Visit&gt; {

    <span class="annotation">@Inject</span>
    <span class="directive">protected</span> ReportGuiManager reportGuiManager;

    <span class="annotation">@Inject</span>
    <span class="directive">protected</span> DataManager dataManager;

    <span class="annotation">@Inject</span>
    <span class="directive">protected</span> TimeSource timeSource;

    <span class="annotation">@Subscribe</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">visitsTable.lastMonthReport</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">protected</span> <span class="type">void</span> onVisitsTableLastMonthReport(
            <span class="predefined-type">Action</span>.ActionPerformedEvent event
    ) {

        TimeRange visitDateTimeRange =
                MonthYearValue
                        .fromDate(today())
                        .minusMonths(<span class="integer">1</span>); <i class="conum" data-value="1"></i><b>(1)</b>

        reportGuiManager.printReport( <i class="conum" data-value="2"></i><b>(2)</b>
                loadReportByCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">visits-by-period</span><span class="delimiter">&quot;</span></span>), <i class="conum" data-value="3"></i><b>(3)</b>
                ParamsMap.of( <i class="conum" data-value="4"></i><b>(4)</b>
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">visitDateRangeStart</span><span class="delimiter">&quot;</span></span>, visitDateTimeRange.getStart(),
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">visitDateRangeEnd</span><span class="delimiter">&quot;</span></span>, visitDateTimeRange.getEnd()
                        )
        );
    }

    <span class="directive">private</span> LocalDate today() {
        <span class="keyword">return</span> timeSource.now().toLocalDate();
    }

    <span class="directive">private</span> Report loadReportByCode(<span class="predefined-type">String</span> reportCode) {
        <span class="keyword">return</span> dataManager.load(Report.class)
                .query(<span class="string"><span class="delimiter">&quot;</span><span class="content">select e from report$Report e where e.code = :reportCode</span><span class="delimiter">&quot;</span></span>)
                .parameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">reportCode</span><span class="delimiter">&quot;</span></span>, reportCode)
                .one();
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the last month based on today&#8217;s date is identified</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>reportGuiManager.printReport</code> is the API for starting the execution of a report and downloading it immediately</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the correct report instance needs to be loaded from the database. Here it is fetched by relying on the <code>code</code> attribute value</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>a parameter map is passed in containing the start and end date range parameter of the report through the <code>MonthYearValue</code> object</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main part for passing in the external parameters is the definition of the last month:</p>
</div>
<div class="paragraph">
<p><code>TimeRange visitDateTimeRange = MonthYearValue.fromDate(today()).minusMonths(1);</code>.</p>
</div>
<div class="paragraph">
<p>The <code>TimeRange</code> class is a custom abstraction of the example
application that provides an API to define a Time Range (either a MonthYear range or a Quarter range) and has methods to get the border values of the range.</p>
</div>
<div class="paragraph">
<p>After the definition of the parameters' values, the <code>reportGuiManager.printReport</code> has the ability to pass in a Map of parameters.</p>
</div>
<div class="paragraph">
<p>The keys of the Map have to match the <code>parameterAlias</code> value of the parameter as configured in the Report Entity.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a><a class="link" href="#summary">Summary</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this introduction to reports and documents generation, the building blocks of the CUBA add-on <code>Reporting</code> were explained. A report is the concept that allows merging a document template with data from data sources to produce an output document.</p>
</div>
<div class="paragraph">
<p>Both building blocks, the document template as well as the data sources, can be of various kinds. With that it provides a high degree of flexibility when configuring reports to generate output documents.</p>
</div>
<div class="paragraph">
<p>All this configuration is hold in the main entity: <code>Report</code>, which can be created through a UI wizard or manually through the configuration UI. With that differentiation it supports users with different levels of technical capabilities.</p>
</div>
<div class="paragraph">
<p>A report can be run directly through a generic user interface, or programmatically through the code of the application. It is possible to define external parameters, that get passed into the report. With that, reports can be configured in a more generic manner to support multiple use-cases.</p>
</div>
<div class="paragraph">
<p>In this guide two reports were created. The first report uses the PDF generation in order to create a patient record for a pet. The report uses the screens configuration to declaratively configure in which screens the report should be offered.</p>
</div>
<div class="paragraph">
<p>The second report generates an excel sheet containing the visits of the last month. In this case external parameters were leveraged to dynamically pass in a specific date range for the report to work on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further_information"><a class="anchor" href="#further_information"></a><a class="link" href="#further_information">Further Information</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://doc.cuba-platform.com/reporting-7.0/index.html">CUBA docs: Reporting</a></p>
</li>
<li>
<p><a href="https://doc.cuba-platform.com/reporting-7.1/open_office.html">CUBA docs: Reporting - Appendix A: Installing and Configuring OpenOffice</a></p>
</li>
</ul>
</div>
</div>
</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Sidebar (right column) -->
            <div id="blog-sidebar">
                <div class="region region-sidebar ">
                    <section id="block-block-29" class="block block-block clearfix">

                        <div class="guide-panel">
                            <h3 class="header-table-content">Table of contents</h3>
                            <ul class="sectlevel1">
<li><a href="#what_will_be_built">What Will be Built</a>
<ul class="sectlevel2">
<li><a href="#final_application">Final Application</a></li>
<li><a href="#requirements">Requirements</a></li>
</ul>
</li>
<li><a href="#example_cuba_petclinic">Example: CUBA petclinic</a></li>
<li><a href="#overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#example_use_cases">Example Use Cases</a></li>
</ul>
</li>
<li><a href="#templates_data_document">Templates + Data = Document</a>
<ul class="sectlevel2">
<li><a href="#the_document_template">The Document Template</a></li>
<li><a href="#data_sources">Data Sources</a></li>
</ul>
</li>
<li><a href="#report_configuration">Report Configuration</a>
<ul class="sectlevel2">
<li><a href="#the_report_wizard">The Report Wizard</a></li>
<li><a href="#external_parameters">External Parameters</a></li>
</ul>
</li>
<li><a href="#patient_record">Patient Record</a>
<ul class="sectlevel2">
<li><a href="#defining_the_attributes">Defining the Attributes</a></li>
<li><a href="#configuring_the_output_document">Configuring the Output document</a></li>
<li><a href="#libreoffice_for_accurate_word_to_pdf_conversion">LibreOffice for accurate Word to PDF conversion</a></li>
<li><a href="#running_the_report_from_the_pet_detail_screen">Running the Report from the Pet Detail Screen</a></li>
</ul>
</li>
<li><a href="#recent_visits_report">Recent Visits Report</a>
<ul class="sectlevel2">
<li><a href="#selecting_entity_attributes_of_the_visit_entity">Selecting Entity Attributes of the Visit Entity</a></li>
<li><a href="#providing_external_parameters_programmatically">Providing External Parameters Programmatically</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#further_information">Further Information</a></li>
</ul>
                        </div>

                        <div class="sidebar-razd"></div>
                        <div class="guide-panel download">
                            <a href="https://github.com/cuba-guides/cuba-petclinic-intro-to-reports" class="github-link" target="_blank">Example code on Github</a>
                        </div>
                        <div class="guide-panel cuba-version">Supported versions: CUBA 7.0+; Java 8+</div>

                    </section>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer fragment="14269c1b298" class="footer">
    <div class="container footer_container">
        <div class="footer_columns">
            <div class="footer_column">
                <div class="footer-menu"><h4 class="footer-menu_label">Framework</h4>
                    <ul class="footer-menu_nav">
                        <li><a href="/framework/">Framework</a></li>
                        <li><a href="/tools/">Tools</a></li>
                        <li><a href="/marketplace/">Addons</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer_column">
                <div class="footer-menu"><h4 class="footer-menu_label">Learn</h4>
                    <ul class="footer-menu_nav">
                        <li><a href="/learn/quickstart/">Quick Start</a></li>
                        <li><a href="/learn/live-demo/">Live Demo</a></li>
                        <li><a href="/guides/">Guides</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer_column">
                <div class="footer-menu"><h4 class="footer-menu_label">Documentation</h4>
                    <ul class="footer-menu_nav">
                        <li><a href="/documentation/">Documentation</a></li>
                        <li><a href="/api-reference/">API References</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer_column">
                <div class="footer-menu"><h4 class="footer-menu_label">Community</h4>
                    <ul class="footer-menu_nav">
                        <li><a href="/discuss/">Forum</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/contacts/">Contacts</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer_bottom">
            <div class="footer_copyright">
                Developed and sponsored by Haulmont
                <a href="https://www.cuba-platform.com/terms-of-use/" class="footer_terms">Terms of Use</a></div>
            <ul class="social footer_social">
                <li class="social_item">
                    <a href="https://github.com/cuba-platform/cuba" target="_blank" class="social_link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon -github social_icon">
                        <path d="M3.047 3.188C5.109 1.062 7.594 0 10.5 0c2.906 0 5.383 1.055 7.43 3.164C19.977 5.274 21 7.812 21 10.781c0 2.344-.672 4.453-2.016 6.328-1.343 1.875-3.062 3.172-5.156 3.891h-.187c-.375 0-.563-.187-.563-.563l.024-1.054c.015-.672.023-1.29.023-1.852 0-.906-.25-1.578-.75-2.015 1.438-.188 2.602-.649 3.492-1.383.89-.735 1.336-2.04 1.336-3.914 0-1.125-.36-2.094-1.078-2.906.313-.907.281-1.86-.094-2.86h-.234c-.719 0-1.61.375-2.672 1.125a9.858 9.858 0 0 0-2.625-.375c-.844 0-1.719.125-2.625.375-1.063-.75-1.953-1.125-2.672-1.125H4.97c-.375 1-.407 1.953-.094 2.86-.719.812-1.078 1.78-1.078 2.906 0 1.875.437 3.18 1.312 3.914s2.032 1.195 3.47 1.383c-.345.343-.563.828-.657 1.453a2.687 2.687 0 0 1-1.219.281c-.781 0-1.39-.39-1.828-1.172-.406-.687-.953-1.062-1.64-1.125-.657 0-.673.219-.047.656.468.25.859.782 1.171 1.594.032.125.094.274.188.445.094.172.351.399.773.68.422.281.93.422 1.524.422.437 0 .781-.031 1.031-.094v1.828c0 .344-.172.516-.516.516h-.187c-2.125-.719-3.852-2.008-5.18-3.867C.664 15.273 0 13.156 0 10.78c0-2.969 1.016-5.5 3.047-7.594z" fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                </a></li>
                <li class="social_item">
                    <a href="https://www.linkedin.com/company/cuba-platform" target="_blank" class="social_link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon -linkedin social_icon">
                        <path d="M19.305 0c.474 0 .875.155 1.203.465.328.31.492.702.492 1.176v17.554c0 .474-.164.894-.492 1.258-.328.365-.73.547-1.203.547h-17.5c-.474 0-.894-.182-1.258-.547C.182 20.09 0 19.67 0 19.195V1.641C0 1.167.173.775.52.465.866.155 1.294 0 1.805 0h17.5zM6.775 17.613V8.129h-2.71v9.484h2.71zM4.431 6.407c.245.245.566.367.964.367s.728-.13.988-.39.39-.574.39-.942c0-.398-.122-.727-.367-.987s-.567-.39-.965-.39-.727.13-.987.39-.39.59-.39.987c0 .368.122.69.367.965zm13.18 11.206v-5.42c0-1.336-.305-2.348-.916-3.034-.612-.687-1.407-1.03-2.386-1.03-1.048 0-1.922.506-2.62 1.517v-1.3H8.806v9.267h2.884v-5.257c0-.361.034-.614.104-.759.28-.722.77-1.083 1.468-1.083.979 0 1.468.668 1.468 2.005v5.094h2.883z" fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                </a></li>
                <li class="social_item">
                    <a href="https://www.facebook.com/CUBAplatform" target="_blank" class="social_link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon -facebook social_icon">
                        <path d="M17.063 0A3.939 3.939 0 0 1 21 3.938v13.124A3.939 3.939 0 0 1 17.062 21h-2.57v-8.135h2.72l.411-3.172h-3.13V7.67c0-.916.245-1.531 1.571-1.531l1.668-.014v-2.83c-.287-.041-1.285-.123-2.433-.123-2.42 0-4.088 1.476-4.088 4.183v2.338H8.477v3.172h2.734V21H3.937A3.939 3.939 0 0 1 0 17.062V3.938A3.939 3.939 0 0 1 3.938 0h13.124z" fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                </a></li>
                <li class="social_item">
                    <a href="https://twitter.com/CubaPlatform" target="_blank" class="social_link">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon -twitter social_icon">
                            <path d="M17.5 6.59a6.058 6.058 0 0 1-1.654.465 2.903 2.903 0 0 0 1.271-1.6 5.717 5.717 0 0 1-1.832.697 2.847 2.847 0 0 0-2.092-.902 2.87 2.87 0 0 0-2.87 2.871c0 .219.013.451.068.656A8.158 8.158 0 0 1 4.457 5.77c-.246.423-.396.93-.396 1.449 0 .998.464 1.873 1.244 2.392-.479-.013-.93-.15-1.367-.355v.027c0 1.395 1.052 2.557 2.365 2.817-.246.068-.438.109-.698.109-.177 0-.355-.027-.533-.055a2.889 2.889 0 0 0 2.68 1.996A5.782 5.782 0 0 1 3.5 15.34a8.183 8.183 0 0 0 4.402 1.285c5.278 0 8.176-4.375 8.176-8.176 0-.123 0-.246-.014-.369A5.521 5.521 0 0 0 17.5 6.59zM21 3.938v13.124A3.939 3.939 0 0 1 17.062 21H3.938A3.939 3.939 0 0 1 0 17.062V3.938A3.939 3.939 0 0 1 3.938 0h13.124A3.939 3.939 0 0 1 21 3.938z" fill="currentColor" fill-rule="evenodd"></path>
                        </svg>
                    </a>
                </li>
                <li class="social_item">
                    <a href="https://www.youtube.com/c/CubaPlatform" target="_blank" class="social_link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon -youtube social_icon">
                        <path d="M27.836 4.648c.11 1.97.164 3.92.164 5.852 0 1.932-.055 3.883-.164 5.852 0 1.24-.392 2.287-1.176 3.144-.784.857-1.74 1.285-2.87 1.285-2.808.146-6.071.219-9.79.219-3.719 0-6.982-.073-9.79-.219-1.13 0-2.086-.428-2.87-1.285C.556 18.64.164 17.591.164 16.352.054 14.382 0 12.432 0 10.5c0-1.276.073-3.227.219-5.852 0-1.24.383-2.287 1.148-3.144C2.133.647 3.081.219 4.211.219 6.872.073 9.97 0 13.508 0h.984c3.537 0 6.636.073 9.297.219 1.13 0 2.087.428 2.871 1.285.784.857 1.176 1.905 1.176 3.144zM11.32 15.86l7.93-5.359-7.93-5.414v10.773z" fill="currentColor" fill-rule="evenodd"></path>
                    </svg>
                </a></li>
                <li class="social_item">
                    <a href="/rss.xml" class="social_link">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon -rss social_icon">
                            <path d="M.857 15.91C1.464 15.305 2.18 15 3 15c.821 0 1.527.295 2.116.884.59.59.884 1.295.884 2.116 0 .821-.295 1.527-.884 2.116-.59.59-1.295.884-2.116.884-.821 0-1.527-.295-2.116-.884C.294 19.526 0 18.821 0 18c0-.821.286-1.518.857-2.09zM0 7c3.828 0 7.118 1.376 9.871 4.129C12.624 13.882 14 17.172 14 21H9.625c0-2.917-.875-5.25-2.625-7s-4.083-2.625-7-2.625V7zm0-7c5.797 0 10.746 2.05 14.848 6.152C18.949 10.254 21 15.203 21 21h-4.375c0-4.667-1.604-8.604-4.813-11.813C8.604 5.98 4.668 4.375 0 4.375V0z" fill="currentColor" fill-rule="evenodd"></path>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</footer>
<!--<script src="https://cuba-nuxt.demo.haulmont.com/_nuxt/83f852ef4b5c91802566.js" defer></script>
<script src="https://cuba-nuxt.demo.haulmont.com/_nuxt/d3a40ea16eeb2e16777d.js" defer></script>
<script src="https://cuba-nuxt.demo.haulmont.com/_nuxt/9bd7e05c04e06e762b47.js" defer></script>
<script src="https://cuba-nuxt.demo.haulmont.com/_nuxt/70ff0a2e2f971caf4892.js" defer></script>
<script src="https://cuba-nuxt.demo.haulmont.com/_nuxt/cf082d0abe0e606c10b9.js" defer></script>-->
<style>
    [class*="column"] + [class*="column"]:last-child {
        float: none;
    }
</style>


<!-- BEGIN FOOTER -->
<!--<footer id="footer">
    <div class="footer-wrapper cuba-container">
        <div class="region region-footer-sitemap">
            <section id="block-footer-sitemap-footer-sitemap" class="block block-footer-sitemap clearfix">
                <div id="footer-sitemap" class="clearfix">
                    <div class="fs-block-content">
                        <div class="menu-footer-sitemap">
                            <ul class="footer_links_menu-footer-sitemap total-items-5 parent-items-0 single-items-0">
                                <li class="menu-1466 depth-1 total-children-4 parent-children-0 single-children-4  first">
                                    <a href="/framework" class="fs-root-link">Platform</a>
                                    <ul class="footer_links_menu-footer-sitemap total-items-4 parent-items-0 single-items-0">
                                        <li class="menu-2770 depth-2 fs-no-children  first"><a href="/framework">The Framework</a></li>
                                        <li class="menu-1473 depth-2 fs-no-children"><a href="/development-tools">Development Tools</a></li>
                                        <li class="menu-2838 depth-2 fs-no-children last"><a href="/marketplace">Marketplace</a></li>
                                    </ul>
                                </li>
                                <li class="menu-1469 depth-1 total-children-7 parent-children-0 single-children-7">
                                    <a href="/online-demo" class="fs-root-link">Learn</a>
                                    <ul class="footer_links_menu-footer-sitemap total-items-7 parent-items-0 single-items-0">
                                        <li class="menu-1479 depth-2 fs-no-children first"><a href="/online-demo">Online demo</a></li>
                                        <li class="menu-1477 depth-2 fs-no-children"><a href="/quickstart">Quick start</a></li>
                                        <li class="menu-1478 depth-2 fs-no-children"><a href="/documentation">Documentation</a></li>
                                        <li class="menu-1731 depth-2 fs-no-children"><a href="/guides">Guides</a></li>
                                        <li class="menu-1773 depth-2 fs-no-children"><a href="/webinars">Webinars</a></li>
                                        <li class="menu-1602 depth-2 fs-no-children last"><a href="/faq">FAQ</a></li>
                                    </ul>
                                </li>
                                <li class="menu-1603 depth-1 total-children-3 parent-children-0 single-children-3"><a
                                        href="https://www.cuba-platform.com/discuss/" class="fs-root-link">Community</a>
                                    <ul class="footer_links_menu-footer-sitemap total-items-3 parent-items-0 single-items-0">
                                        <li class="menu-1604 depth-2 fs-no-children first"><a href="https://www.cuba-platform.com/discuss/">Forum</a></li>
                                        <li class="menu-1692 depth-2 fs-no-children"><a href="/testimonials">Customer stories</a></li>
                                        <li class="menu-1615 depth-2 fs-no-children last"><a href="/blog">Blog</a></li>
                                    </ul>
                                </li>
                                <li class="menu-1663 depth-1 total-children-3 parent-children-0 single-children-3"><a
                                        href="/training" class="fs-root-link">Services</a>
                                    <ul class="footer_links_menu-footer-sitemap total-items-3 parent-items-0 single-items-0">
                                        <li class="menu-1756 depth-2 fs-no-children first"><a href="/training">Training</a></li>
                                        <li class="menu-1757 depth-2 fs-no-children"><a href="/support-options">Support</a></li>
                                        <li class="menu-1758 depth-2 fs-no-children last"><a href="/deployment">Development</a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="menu-1612 depth-1 total-children-3 parent-children-0 single-children-3  last">
                                    <a href="/download" class="fs-root-link">More</a>
                                    <ul class="footer_links_menu-footer-sitemap total-items-3 parent-items-0 single-items-0">
                                        <li class="menu-2773 depth-2 fs-no-children first"><a href="/download">Download</a></li>
                                        <li class="menu-2775 depth-2 fs-no-children"><a href="/store">Store</a></li>
                                        <li class="menu-1480 depth-2 fs-no-children last"><a href="/contacts">Contacts</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

            </section>
        </div>
        <div class="region region-footer-copyright">
            <section id="block-block-14" class="block block-block clearfix">
                <div class="footer-copyright">
                    <div class="copyright">Copyright &copy; 2008-2018 Haulmont</div>
                    <div class="licences"><a href="/terms-of-use">Terms of Use</a></div>
                    <div class="socials">
                        <ul>
                            <li><a href="https://github.com/cuba-platform/cuba" class="socials-icon github"></a></li>
                            <li><a href="https://www.youtube.com/c/CubaPlatform" class="socials-icon youtube"></a></li>
                            <li><a href="https://www.facebook.com/CUBAplatform" class="socials-icon facebook"></a></li>
                            <li><a href="https://twitter.com/CubaPlatform" class="socials-icon twitter"></a></li>
                            <li><a href="https://www.linkedin.com/company/cuba-platform" class="socials-icon linkedin"></a></li>
                            <li><a href="https://www.cuba-platform.com/rss.xml" class="socials-icon rss"></a></li>
                        </ul>
                    </div>
                </div>
                <script async defer src="https://buttons.github.io/buttons.js"></script>
            </section>
        </div>
    </div>
</footer>-->
<!-- END FOOTER -->
<div class="scrollTop"></div>
</section>

<script src="/guides/js/foundation.min.js"></script>
<script src="https://unpkg.com/isotope-layout@3.0/dist/isotope.pkgd.js"></script>
<script src="/guides/js/vendor/modernizr.js"></script>
<script src="/guides/js/toc.js"></script>
<script src="/guides/js/navigation.js"></script>
<script src="/guides/js/navbar.js"></script>
<script src="/guides/js/extra.js"></script>
<script src="/guides/js/extra2.js"></script>
<script src="/guides/js/cuba-new.js"></script>
<script>
(function ($) {
  $(document).foundation();
  var doc = document.documentElement;
  doc.setAttribute('data-useragent', navigator.userAgent)

  /* Issue #24 */
  $(".blog .content img").each(function() {
    var imgMarkup = $(this)[0].outerHTML;
    console.log(imgMarkup);
    $(this).replaceWith('<div class="img-center">' + imgMarkup + '</div>');
  });

})(jQuery);

// Cache selectors
var lastId,
    topMenu = $(".sectlevel1"),
    topMenuHeight = topMenu.outerHeight()+1,

    // All list items
    menuItems = topMenu.find("a"),
    // Anchors corresponding to menu items
    scrollItems = menuItems.map(function(){
        var item = $($(this).attr("href"));
        if (item.length) { return item; }
    });
console.log(topMenuHeight );
menuItems.click(function(e){
    var href = $(this).attr("href"),
        offsetTop = href === "#" ? 0 : $(href).offset().top - 85;
    $('html, body').stop().animate({
        scrollTop: offsetTop
    }, 850);
    e.preventDefault();
    window.location =  href;
});

$( document ).ready(function() {
    const hash = location.hash.replace('#','');
    if(hash !== ''){
        $('html, body').stop().animate({ scrollTop: $('a[href=#' + hash + ']').offset().top - 85}, 850);
    }
});

// Bind to scroll
$(window).scroll(function(){
    // Get container scroll position
    var fromTop = $(this).scrollTop()+topMenuHeight;

    // Get id of current scroll item
    var cur = scrollItems.map(function(){
        if ($(this).offset().top < fromTop)
            return this;
    });
    // Get the id of the current element
    cur = cur[cur.length-1];
    var id = cur && cur.length ? cur[0].id : "";

    if (lastId !== id) {
        lastId = id;
        // Set/remove active class
        menuItems
            .parent().removeClass("active")
            .end().filter("[href=#"+id+"]").parent().addClass("active");
    }
});

</script>
</body>
</html>
